package se.menu;

import java.awt.CardLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.ArrayList;

import javax.swing.BorderFactory;
import javax.swing.Box;
import javax.swing.BoxLayout;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextField;
import javax.swing.border.Border;

import se.request.Request;
import se.request.RequestData;
import se.warden.*;

public class WardenMenu extends JFrame
{
	JPanel sidepanel;
	JPanel mainpanel;
	JPanel requestmenu;
	JPanel summarymenu;
	JPanel profile;
	WardenData data;
	Warden Mobj;
	Request Robj;
	WardenMenu(WardenData obj , JFrame prev)
	{
		this.data = obj;
		Mobj = new Warden();
		Robj = new Request();
		setSize(1030,550);
		addSidePanel();
		addMainPanel();
		setLayout(null);
		setResizable(false);
		setVisible(true);
		prev.dispose();
	}
	private void addSidePanel()
	{
		JPanel sidepanel = new JPanel();
		JLabel menuname = new JLabel("Warden Portal");
		menuname.setForeground(Color.white);
		menuname.setBounds(50,0,200,50);
		
		JButton RRequest = new JButton("Requests");
		RRequest.setBounds(0,150,200,30);
		RRequest.setBackground(Color.WHITE);
		RRequest.setForeground(Color.BLACK);
		RRequest.addActionListener(new MenuButton());
		
		JButton Summary = new JButton("Summary");
		Summary.setBounds(0,200,200,30);
		Summary.setBackground(Color.WHITE);
		Summary.setForeground(Color.BLACK);
		Summary.addActionListener(new MenuButton());
		
		JButton Profile = new JButton("Profile");
		Profile.setBounds(0,250,200,30);
		Profile.setBackground(Color.WHITE);
		Profile.setForeground(Color.BLACK);
		Profile.addActionListener(new MenuButton());
		
		sidepanel.add(RRequest);
		sidepanel.add(Summary);
		sidepanel.add(menuname);
		sidepanel.add(Profile);
		
		sidepanel.setBounds(0, 0,200,500);
		sidepanel.setBackground(new Color(39,39,39));
		sidepanel.setLayout(null);
		this.add(sidepanel);
	}
	private void addMainPanel()
	{
		mainpanel = new JPanel();
		mainpanel.setBounds(200,0,810,500);
		mainpanel.setBackground(Color.WHITE);
		mainpanel.setLayout(new CardLayout());
		addRMenu(mainpanel);
		addSummary(mainpanel);
		addProfile(mainpanel);
		this.add(mainpanel);
	}
	private void addRMenu(JPanel obj)
	{
		requestmenu = new JPanel();
		JScrollPane listScroller = new JScrollPane(requestmenu);
		listScroller.setPreferredSize(new Dimension(800,550));
		requestmenu.setPreferredSize(new Dimension(800, 550));
		listScroller.setAlignmentX(RIGHT_ALIGNMENT);
		ArrayList<RequestData> rdata = Robj.getRequestbyHostel(data.HostelId);
		requestmenu.setLayout(new BoxLayout(requestmenu, BoxLayout.PAGE_AXIS));
		if(rdata != null)
			for(RequestData x : rdata)
			{
				if(x.Status == 2)
					requestmenu.add(getRequest(x));
				requestmenu.add(Box.createRigidArea(new Dimension(0,5)));
			}
		obj.add(listScroller , "Requests");
	}
	
	private JPanel getRequest(RequestData request)
	{
		Border blackline = BorderFactory.createLineBorder(Color.black);
		JPanel panel = new JPanel();
		panel.setLayout(null);
		panel.setBorder(blackline);
		panel.setSize(new Dimension(800,200));
		
		JLabel requestId = new JLabel("Request ID: " + request.RequestId);
		requestId.setBounds(5,0,250,20);
		panel.add(requestId);
		
		JLabel StudentId = new JLabel("Student ID: "+request.StudentId);
		StudentId.setBounds(255,0,200,20);
		panel.add(StudentId);
		
		JLabel From = new JLabel("From Date: " + request.fromDate);
		From.setBounds(450,0,200,20);
		panel.add(From);
		
		JLabel To = new JLabel("To Date: "+ request.toDate);
		To.setBounds(650,0,200,20);
		panel.add(To);
		
		JLabel Destination = new JLabel("Destination: " + request.Destination);
		Destination.setBounds(5,40,250,20);
		panel.add(Destination);
		
		String type = "";
		if(request.RequestType == 1)
			type = "Outing";
		else if(request.RequestType == 2)
			type = "Vacation";
		else
			type = "Medical";
		JLabel Type = new JLabel("Type: "+ type);
		Type.setBounds(255,40,250,20);
		panel.add(Type);
		
		JButton accept = new JButton("Accept");
		accept.setBounds(450,40,100,30);
		panel.add(accept);
		accept.addActionListener( new ActionListener() 
		{
			public void actionPerformed(ActionEvent e) 
			{
				if(Robj.updateRequestbyWarden(request.RequestId,6," "))
				{
					requestmenu.remove(panel);
					requestmenu.revalidate();
					requestmenu.repaint();
				}
			}
			
		});
		
		JButton decline = new JButton("Decline");
		decline.setBounds(550,40,100,30);
		panel.add(decline);
		decline.addActionListener(new ActionListener()
				{
					public void actionPerformed(ActionEvent e)
					{
						if(Robj.updateRequestbyWarden(request.RequestId,5," "))
						{
							requestmenu.remove(panel);
							requestmenu.revalidate();
							requestmenu.repaint();
						}
					}
				});
		
		JButton view = new JButton("Reconsider");
		view.setBounds(650,40,130,30);
		panel.add(view);
		view.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e)
			{
				String comment = JOptionPane.showInputDialog(panel,"Enter Comment");
				if(Robj.updateRequestbyWarden(request.RequestId,4,comment))
				{
					requestmenu.remove(panel);
					requestmenu.revalidate();
					requestmenu.repaint();
				}
			}
		});
		
		return panel;
	}
	private void addSummary(JPanel obj)
	{
		JPanel panel = new JPanel();
		JLabel heading = new JLabel("Summary");
		heading.setBounds(405,5,810,30);
		panel.add(heading);
		JLabel one = new JLabel("Total Active requests");
		one.setBounds(10, 100,200, 30);
		JLabel two = new JLabel("Total Requests");
		two.setBounds(10,150,200,30);
		JLabel three = new JLabel("Students out of campus");
		three.setBounds(10, 200, 200, 30);
		panel.add(three);
		panel.add(one);
		panel.add(two);
		panel.setLayout(null);
		obj.add(panel , "Summary");
	}
	private void addProfile(JPanel obj)
	{
		JPanel panel = new JPanel();
		panel.setLayout(null);
		JLabel heading = new JLabel("Profile");
		heading.setBounds(405,5,810,30);
		panel.add(heading);
		JLabel id = new JLabel("New Employee Id");
		id.setBounds(10,100,200,30);
		JLabel idvalue = new JLabel(data.EmployeeId);
		idvalue.setBounds(220,100,200,30);
		JLabel name = new JLabel("Name");
		name.setBounds(10,150,200, 30);
		JLabel namevalue = new JLabel(data.name);
		namevalue.setBounds(220, 150, 200, 30);
		JLabel email = new JLabel("Email:");
		email.setBounds(10,200,200,30);
		JLabel valueemail = new JLabel(data.Emailid);
		valueemail.setBounds(220,200,200,30);
		JLabel hostel = new JLabel("Hostel ID");
		hostel.setBounds(10, 250, 200, 30);
		JLabel hostelvalue = new JLabel(data.HostelId);
		hostelvalue.setBounds(220, 250, 200, 30);
		
		panel.add(hostel);
		panel.add(hostelvalue);
		panel.add(id);
		panel.add(idvalue);
		panel.add(name);
		panel.add(namevalue);
		panel.add(email);
		panel.add(valueemail);
		
		JLabel uppass = new JLabel("Update Password");
		uppass.setBounds(10, 345 ,200,30);
		panel.add(uppass);
		
		JTextField newpass = new JTextField("New Pasword");
		newpass.setBounds(220,350,100,20);
		panel.add(newpass);
		
		JButton update = new JButton("Update");
		update.setBounds(350,350,100,20);
		update.addActionListener(new ActionListener() {
			
			public void actionPerformed(ActionEvent e) 
			{
				String newpassword = newpass.getText();
				if(newpassword.length() == 0)
				{
					JOptionPane.showMessageDialog(panel,"Enter correct password");
					return;
				}
				
				if(Mobj.updateWardenPassword(data.EmployeeId,))
				{
					JOptionPane.showMessageDialog(panel,"Password Updated");
					newpass.setText("");
				}
			}
			
		});
		panel.add(update);
		
		obj.add(panel , "Profile");
	}
	public static void main(String agrs[])
	{
		Warden obj = new Warden();
		new WardenMenu(obj.getWardenById("EHW2019") , new JFrame());
	}
	class MenuButton implements ActionListener
	{
		public void actionPerformed(ActionEvent e) 
		{
			String name = e.getActionCommand();
			CardLayout obj = (CardLayout) mainpanel.getLayout();
			obj.show(mainpanel, name);
		}
		
	}
}